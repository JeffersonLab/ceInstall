#%Module

#conflict .geant4

# Environment

set base_dir $env(PHYS_HOME)/$env(OSRELEASE)/$env(PHYS_SUB_DIR)/$env(PHYS_VERSION)

set dir $base_dir/geant4/${version}
set lib_location lib

# set LD_LIBRARY_PATH depending on Darwin/Linux
if { [uname sysname] == "Linux" } {
	set lib_location lib64
}

prepend-path PATH $dir/bin
prepend-path LD_LIBRARY_PATH $dir/$lib_location
if { [uname sysname] == "Darwin" } {
	prepend-path DYLD_LIBRARY_PATH $dir/$lib_location
}

setenv G4INSTALL $dir
setenv G4LIB $dir/$lib_location
setenv G4_VERSION $version


proc ModulesTest { } {

	set var Geant4

	set installation_dir  [ getenv G4LIB ]
	set retcode 1


	# exit if is_loaded is empty
	if { [module-info loaded physlibs] == "" } {
		puts stderr "physlibs is not loaded. Use module load physlibs to load it."
		puts stderr ""
		return 0
	}
	
	puts stderr ""
	if { [file isdirectory $installation_dir ] } {
		puts stderr " Y $var $installation_dir"
	} else {
		puts stderr " N $var $installation_dir"
		set retcode 0
	}

	return $retcode
}

